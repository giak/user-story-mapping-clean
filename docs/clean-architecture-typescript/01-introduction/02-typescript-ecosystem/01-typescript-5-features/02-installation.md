# Installation du Projet üèóÔ∏è

> *"Comme la construction d'une maison progresse des fondations vers le toit, notre projet se construit √©tape par √©tape avec des outils et configurations appropri√©s."*

## Pr√©requis üìã

Assurez-vous d'avoir configur√© votre environnement selon le [guide d'environnement](./01-environment.md) :
- Node.js (v22.12.0+)
- pnpm (v9.14.4+)
- Git (v2.43+)
- VSCode ou Cursor IDE

## 1. Cr√©ation du Projet avec Vite üöÄ

Tout comme un architecte dispose de plusieurs approches pour d√©marrer la construction d'une maison, Vite nous offre diff√©rentes m√©thodes pour initialiser notre projet. Voici la m√©thode recommand√©e :

### A. Installation de Vite üõ†Ô∏è

Commen√ßons par installer Vite globalement :

```bash
# Installation globale de Vite
pnpm add -g create-vite@latest

# V√©rification de l'installation
create-vite --version    # Devrait afficher 5.0.0 ou sup√©rieur
```

### B. Cr√©ation via Template üìã

```bash
# M√©thode interactive (recommand√©e)
pnpm create vite

# Ou directement avec les options
pnpm create vite clean-architecture-demo -- --template vue-ts
```

> üí° **Note**: L'option `--template vue-ts` combine Vue.js et TypeScript, id√©al pour notre architecture.

### C. Templates Disponibles üéØ

Vite propose plusieurs templates officiels pour TypeScript :
- `vue` puis `typescript`: choisir ce template

### D. Installation et Configuration üîß

```bash
# Navigation dans le dossier
cd clean-architecture-demo

# Installation des d√©pendances
pnpm install

# Installation des d√©pendances TypeScript essentielles
pnpm add -D typescript@5.7.2 \           # TypeScript lui-m√™me
         @types/node@22.10.1 \           # Types pour Node.js
         vue-tsc@2.1.10 \                # V√©rification des types Vue
         @vitejs/plugin-vue@5.2.4 \      # Plugin Vue pour Vite
         @vue/tsconfig@0.7.0 \           # Configuration TypeScript pour Vue
         @vue/runtime-core@3.5.13 \      # Types Vue core
         @types/web@0.0.186             # Types Web API
```

> üí° **Note**: Ces versions sont compatibles avec Vue 3.4+ et TypeScript 5.7+

### Configuration de Vite pour TypeScript

Cr√©ez ou mettez √† jour `vite.config.ts`:

```typescript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': resolve(__dirname, './src'),
      '@domain': resolve(__dirname, './src/domain'),
      '@application': resolve(__dirname, './src/application'),
      '@infrastructure': resolve(__dirname, './src/infrastructure'),
      '@presentation': resolve(__dirname, './src/presentation'),
      '@shared': resolve(__dirname, './src/shared')
    }
  }
})
```

> üí° **Note**: Cette configuration initiale sera enrichie ult√©rieurement pour supporter des alias dynamiques par contexte m√©tier. Cela permettra d'avoir des imports plus explicites comme `@user/domain` ou `@product/infrastructure`, facilitant ainsi la navigation dans notre architecture modulaire bas√©e sur les contextes.

> üîÑ **√âvolution Pr√©vue**: 
> - Ajout d'alias automatiques pour chaque nouveau contexte
> - Support des sous-dossiers sp√©cifiques par contexte
> - Meilleure organisation des imports entre contextes

## 2. Configuration TypeScript üîß

> üí° **Note**: Comme pour les fondations d'une maison qui doivent √™tre solides, la configuration TypeScript doit √™tre rigoureuse pour garantir la stabilit√© de notre application.

### A. Configuration du Compilateur

Cr√©ez ou mettez √† jour `tsconfig.json` :

```json
{
  "files": [],
  "references": [
    { "path": "./tsconfig.app.json" },
    { "path": "./tsconfig.node.json" }
  ]
}

```

Cr√©ez ou mettez √† jour `tsconfig.app.json` :

```json
{
  "compilerOptions": {
    /* Param√®tres de Base */
    "target": "ES2024",                  // Version ECMAScript cible
    "module": "ESNext",                  // Syst√®me de modules
    "lib": ["ES2024", "DOM", "DOM.Iterable"],
    "useDefineForClassFields": true,     // Support des champs de classe
    "skipLibCheck": true,                // Optimisation de la v√©rification

    /* Param√®tres du Bundler */
    "moduleResolution": "bundler",       // R√©solution des modules optimis√©e pour Vite
    "allowImportingTsExtensions": true,  // Permet l'import de fichiers .ts
    "resolveJsonModule": true,           // Support des imports JSON
    "isolatedModules": true,            // Garantit la compatibilit√© avec les bundlers
    "noEmit": true,                     // Pas d'√©mission de fichiers JS (g√©r√© par Vite)
    "jsx": "preserve",                  // Pr√©serve le JSX pour Vue

    /* V√©rifications Strictes */
    "strict": true,                     // Active toutes les v√©rifications strictes
    "noUnusedLocals": true,            // D√©tecte les variables non utilis√©es
    "noUnusedParameters": true,         // D√©tecte les param√®tres non utilis√©s
    "noFallthroughCasesInSwitch": true, // V√©rification exhaustive des switch
    "useUnknownInCatchVariables": true, // Type 'unknown' pour les catch
    "noUncheckedIndexedAccess": true,   // V√©rification stricte des index
    "exactOptionalPropertyTypes": true,  // Typage strict des propri√©t√©s optionnelles
    "noImplicitOverride": true,         // Obligation du mot-cl√© override
    "noPropertyAccessFromIndexSignature": true,
    "forceConsistentCasingInFileNames": true,

    /* Chemins et R√©solution */
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"],
      "@domain/*": ["src/domain/*"],
      "@application/*": ["src/application/*"],
      "@infrastructure/*": ["src/infrastructure/*"],
      "@presentation/*": ["src/presentation/*"],
      "@shared/*": ["src/shared/*"],
      "@contexts/*": ["src/contexts/*"]
    }
  },
  "include": [
    "src/**/*.ts",
    "src/**/*.d.ts",
    "src/**/*.tsx",
    "src/**/*.vue"
  ],
  "references": [{ "path": "./tsconfig.node.json" }]
}
```

### B. Configuration Node.js

Cr√©ez ou mettez √† jour `tsconfig.node.json` :

```json
{
  "compilerOptions": {
    "composite": true,
    "skipLibCheck": true,
    "module": "ESNext",
    "moduleResolution": "bundler",
    "allowSyntheticDefaultImports": true,
    "strict": true
  },
  "include": [
    "vite.config.ts",
    "vitest.config.ts",
    "cypress.config.ts"
  ]
}
```

> üîß **Note Technique**: Cette configuration est optimis√©e pour:
> - La derni√®re version d'ECMAScript (ES2024)
> - Une v√©rification de types stricte
> - Une int√©gration optimale avec Vite
> - Un support complet de notre architecture en couches

> ‚ö†Ô∏è **Important**: Les chemins dans `paths` doivent correspondre exactement √† la structure de votre projet. Ajustez-les selon vos besoins.

## 3. Structure du Projet üìÅ

```bash
# Cr√©ation de la structure de base
mkdir -p src/{assets,contexts,docs,infrastructure,initialization,presentation,shared,store,workers}

# Structure minimale des assets
mkdir -p src/assets/styles/scss

# Structure minimale partag√©e
mkdir -p src/shared/{core/{base-classes,interfaces,types},utils}

# Structure minimale de l'infrastructure
mkdir -p src/infrastructure/{config,services}

# Structure minimale de la pr√©sentation
mkdir -p src/presentation/{components,views}

# Structure minimale pour l'initialisation
mkdir -p src/initialization/plugins

# Structure minimale pour le store
mkdir -p src/store/modules

# Exemple minimal d'un contexte
mkdir -p src/contexts/example/{domain,application,infrastructure,presentation}
```

> üí° **Note**: Cette structure de base sera enrichie progressivement selon les besoins du projet.

Structure initiale :

```
src/
‚îú‚îÄ‚îÄ assets/              # Ressources statiques
‚îÇ   ‚îî‚îÄ‚îÄ styles/         # Styles globaux
‚îÇ       ‚îî‚îÄ‚îÄ scss/      # Modules SCSS
‚îÇ
‚îú‚îÄ‚îÄ contexts/          # Domaines m√©tier isol√©s
‚îÇ   ‚îî‚îÄ‚îÄ example/      # Exemple de contexte
‚îÇ       ‚îú‚îÄ‚îÄ domain/        # C≈ìur m√©tier
‚îÇ       ‚îú‚îÄ‚îÄ application/   # Cas d'utilisation
‚îÇ       ‚îú‚îÄ‚îÄ infrastructure/# Adaptateurs
‚îÇ       ‚îî‚îÄ‚îÄ presentation/  # Interface UI
‚îÇ
‚îú‚îÄ‚îÄ infrastructure/   # Configuration globale
‚îÇ   ‚îú‚îÄ‚îÄ config/      # Configurations
‚îÇ   ‚îî‚îÄ‚îÄ services/    # Services techniques
‚îÇ
‚îú‚îÄ‚îÄ initialization/  # Bootstrap application
‚îÇ   ‚îî‚îÄ‚îÄ plugins/    # Plugins Vue.js
‚îÇ
‚îú‚îÄ‚îÄ presentation/   # Composants partag√©s
‚îÇ   ‚îú‚îÄ‚îÄ components/ # Composants UI
‚îÇ   ‚îî‚îÄ‚îÄ views/     # Pages partag√©es
‚îÇ
‚îú‚îÄ‚îÄ shared/        # Code partag√©
‚îÇ   ‚îú‚îÄ‚îÄ core/     # Classes et interfaces base
‚îÇ   ‚îî‚îÄ‚îÄ utils/    # Utilitaires
‚îÇ
‚îî‚îÄ‚îÄ store/        # √âtat global (Pinia)
    ‚îî‚îÄ‚îÄ modules/  # Modules de store
```

> ‚ö†Ô∏è **Important**: Cette structure initiale fournit les bases essentielles pour d√©marrer. Elle sera enrichie au fur et √† mesure du d√©veloppement du projet. Il faut d√©j√† s'habituer √† cette arborescence.

## 4. Installation des D√©pendances üì¶

```bash
# D√©pendances de production essentielles
pnpm install vue@3.4.15 vue-router@4.2.5 pinia@2.1.7 @vueuse/core@10.7.2

# D√©pendances UI et composants
pnpm install primevue@3.48.1 @headlessui/vue@1.7.19 @heroicons/vue@2.1.1

# Support i18n
pnpm install vue-i18n@9.9.0

# Utilitaires
pnpm install date-fns@3.3.1 zod@3.22.4 axios@1.6.7

# D√©pendances de d√©veloppement pour les tests
pnpm install -D vitest@1.2.2 @vitest/coverage-v8@0.34.6 
pnpm install -D @testing-library/vue@8.0.1 @testing-library/jest-dom@6.4.2
pnpm install -D @vue/test-utils@2.4.4 happy-dom@13.3.8

# D√©pendances de d√©veloppement pour le linting et le formatting
pnpm install -D eslint@8.56.0 @typescript-eslint/parser@6.19.1 
pnpm install -D @typescript-eslint/eslint-plugin@6.19.1 eslint-plugin-vue@9.20.1
pnpm install -D prettier@3.2.4 eslint-config-prettier@9.1.0 eslint-plugin-prettier@5.1.3

# D√©pendances de d√©veloppement pour le style
pnpm install -D tailwindcss@3.4.1 postcss@8.4.33 autoprefixer@10.4.17
pnpm install -D sass@1.70.0
```

> üí° **Note**: Ces d√©pendances sont organis√©es par cat√©gorie pour une meilleure lisibilit√© et maintenance.

### Explications des d√©pendances principales

**Production**:
- `vue`: Framework principal
- `vue-router`: Routage officiel de Vue
- `pinia`: Gestion d'√©tat
- `@vueuse/core`: Collection d'utilitaires composables Vue
- `primevue`: Biblioth√®que de composants UI
- `zod`: Validation de sch√©mas TypeScript
- `vue-i18n`: Internationalisation

**D√©veloppement**:
- `vitest`: Framework de test moderne
- `@testing-library/vue`: Utilitaires de test pour Vue
- `eslint` et plugins: Linting du code
- `prettier`: Formatage du code
- `tailwindcss`: Framework CSS utilitaire
- `sass`: Pr√©processeur CSS

> ‚ö†Ô∏è **Important**: Les versions sp√©cifi√©es sont compatibles entre elles et test√©es. Mettez √† jour avec pr√©caution.

## 5. Configuration des Tests üß™

Cr√©ez `vitest.config.ts` :

```typescript
import { defineConfig } from 'vitest/config';
import path from 'path';
import vue from '@vitejs/plugin-vue';

export default defineConfig({
  plugins: [vue()],
  test: {
    globals: true,
    environment: 'happy-dom',
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
      exclude: [
        'node_modules/',
        'src/**/*.d.ts',
        'src/**/*.test.ts',
        'src/**/*.spec.ts'
      ]
    },
    include: ['src/**/*.{test,spec}.{js,ts,jsx,tsx}'],
    exclude: ['node_modules', 'dist']
  },
  resolve: {
    alias: {
      '@domain': path.resolve(__dirname, './src/domain'),
      '@application': path.resolve(__dirname, './src/application'),
      '@infrastructure': path.resolve(__dirname, './src/infrastructure'),
      '@presentation': path.resolve(__dirname, './src/presentation'),
      '@shared': path.resolve(__dirname, './src/shared'),
    },
  },
});
```

## 6. Scripts npm üìù

Mettez √† jour `package.json` :

```json
{
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vue-tsc && vite build",
    "preview": "vite preview",
    "test": "vitest",
    "test:coverage": "vitest run --coverage",
    "test:ui": "vitest --ui",
    "lint": "eslint src --ext .ts,.tsx,.vue",
    "lint:fix": "eslint src --ext .ts,.tsx,.vue --fix",
    "type-check": "vue-tsc --noEmit",
    "format": "prettier --write src/"
  }
}
```

## 7. Configuration ESLint üìê

```bash
pnpm install -D eslint@latest @typescript-eslint/parser@latest @typescript-eslint/eslint-plugin@latest eslint-plugin-vue@latest
```

Cr√©ez `.eslintrc.json` :

```json
{
  "root": true,
  "parser": "vue-eslint-parser",
  "parserOptions": {
    "parser": "@typescript-eslint/parser",
    "sourceType": "module",
    "ecmaVersion": 2024
  },
  "plugins": ["@typescript-eslint"],
  "extends": [
    "eslint:recommended",
    "plugin:@typescript-eslint/strict-type-checked",
    "plugin:@typescript-eslint/stylistic-type-checked",
    "plugin:vue/vue3-recommended"
  ],
  "rules": {
    "@typescript-eslint/no-explicit-any": "error",
    "@typescript-eslint/explicit-function-return-type": "error",
    "@typescript-eslint/no-unused-vars": "error",
    "@typescript-eslint/consistent-type-imports": "error",
    "@typescript-eslint/prefer-readonly": "error"
  }
}
```

## 8. V√©rification de l'Installation ‚úÖ

```bash
# D√©marrage du serveur de d√©veloppement
pnpm run dev

# Ex√©cution des tests
pnpm run test

# V√©rification des types
pnpm run type-check

# V√©rification du linting
pnpm run lint
```

## Points Cl√©s √† Retenir üéØ

1. **Versions Modernes** üöÄ
   - Node.js 22.12.0+ pour les derni√®res fonctionnalit√©s
   - TypeScript 5.7.2+ pour le typage avanc√©
   - Vue 3 pour la r√©activit√© moderne

2. **Configuration Stricte** üõ°Ô∏è
   - TypeScript en mode strict
   - ESLint avec r√®gles avanc√©es
   - Tests complets avec Vitest

3. **Structure Propre** üìê
   - Architecture en couches
   - S√©paration des responsabilit√©s
   - Organisation modulaire

## Pour Aller Plus Loin üìö

- Configurer un syst√®me CI/CD
- Ajouter des outils d'analyse de code
- Mettre en place des hooks git
- Configurer Docker pour le d√©veloppement

## Conclusion üè†

Comme une maison moderne n√©cessite les derni√®res normes de construction, notre projet utilise :
- Les derni√®res versions des outils (Node.js 22.12.0+, TypeScript 5.7.2+)
- Une configuration robuste et stricte
- Des outils de qualit√© modernes
- Une structure claire et maintenable
